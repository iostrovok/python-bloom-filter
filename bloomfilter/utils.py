import zlib


def crc32(data):
    return zlib.crc32(data) & 0xffffffff


def bits(count_bits, size, matrix_list, key):
    for matrix in matrix_list:
        yield one_bits(count_bits, matrix, size, key)


def one_bits(count_bits, matrix, size, key):
    size = 1 + len(key) / count_bits
    while key:
        chunk, key = key[:size], key[size:]
        yield (matrix[i] * (crc32(chunk) % size)) % size


def random_primes():
    return [
        379, 4547, 4297, 6899, 4993, 5749, 4657, 1607, 2417, 4729, 2927, 1129, 3823, 4177, 3769, 2039, 6763, 7517, 1259, 4871, 3613, 7283,
        3061, 523, 4519, 2879, 2957, 1451, 3209, 911, 569, 751, 5743, 1049, 4007, 617, 6337, 6971, 3181, 7457, 1973, 3529, 4649, 3037, 191,
        4861, 4999, 271, 887, 5051, 2557, 3169, 6833, 4507, 1213, 811, 2029, 4231, 787, 1381, 4691, 4639, 4759, 4441, 439, 5881, 1361, 2003,
        6907, 3559, 5737, 3739, 5827, 6043, 3253, 7841, 5741, 5087, 5869, 2549, 7873, 557, 6301, 6451, 2909, 727, 463, 461, 53, 6791, 6577,
        3581, 863, 3491, 5527, 5569, 4651, 4327, 937, 4919, 7907, 827, 6073, 3911, 3547, 4157, 229, 5573, 331, 3593, 1399, 2693, 5657, 6173,
        1627, 499, 1987, 2383, 6737, 5791, 743, 7699, 5309, 7583, 1901, 4603, 7883, 2293, 5167, 4261, 7573, 6551, 3821, 5641, 6011, 4751, 6703,
        883, 3257, 2161, 2111, 2749, 3571, 353, 6857, 7537, 2053, 269, 5531, 1699, 7417, 4723, 6871, 4567, 7127, 397, 3659, 1483, 2099, 6869,
        5107, 5563, 241, 6449, 1823, 541, 3011, 7151, 3407, 6037, 2137, 6569, 3527, 11, 6079, 7649, 211, 3067, 2887, 5693, 4423, 103, 4967, 97,
        7789, 7069, 7901, 1453, 5501, 3779, 6131, 5147, 3371, 1429, 2647, 4591, 2251, 2579, 5591, 3467, 6911, 769, 4877, 2731, 5171, 5683, 2713,
        3833, 1021, 2609, 6827, 3877, 1949, 2267, 6133, 4637, 4621, 7829, 521, 2797, 3637, 6863, 661, 4481, 6221, 7681, 6143, 431, 587, 1667, 6197,
        4561, 3793, 7309, 6701, 3119, 1033, 5659, 1913, 2971, 5077, 5981, 19, 3851, 6373, 1579, 4703, 3623, 3853, 1877, 3709, 7247, 4933, 7219,
        4211, 2621, 5189, 2441, 347, 4139, 3167, 3697, 1223, 3203, 4217, 6211, 5923, 6823, 2803, 2467, 3217, 13, 2129, 953, 4013, 2371, 6101, 313,
        5443, 509, 337, 1061, 6343, 5813, 2339, 2333, 6709, 5273, 5119, 7013, 1951, 4813, 1759, 4451, 6673, 5903, 4201, 5939, 7621, 7177, 2309, 5843,
        6829, 3917, 149, 1543, 7057, 251, 359, 3347, 6469, 1619, 2897, 5323, 1459, 7193, 2203, 599, 443, 829, 2707, 1787, 1847, 109, 4289, 659, 1481,
        5653, 3049, 7027, 4273, 1559, 857, 1571, 7253, 3259, 5431, 613, 5441, 1733, 1427, 1279, 7459, 1103, 1889, 3413, 2963, 3121, 7607, 17, 7643,
        47, 2917, 4889, 1523, 6121, 6563, 971, 3461, 4397, 1831, 7369, 967, 5867, 1499, 2699, 2411, 4597, 23, 3889, 739, 2069, 7879, 1811, 773, 5779,
        5303, 6229, 307, 5471, 4663, 2591, 1873, 2131, 7823, 2447, 6761, 1193, 1163, 7043, 7, 5581, 7549, 7639, 643, 2833, 5209, 2237, 6323, 7109,
        6053, 7817, 4337, 2213, 139, 4357, 1303, 1487, 7561, 4721, 6793, 3863, 5651, 1489, 5953, 5783, 3617, 6367, 5, 1553, 5399, 2221, 647, 3191,
        4463, 7333, 4373, 1367, 7307, 2297, 1933, 4783, 2543, 3001, 1249, 7919, 127, 7523, 3583, 4457, 1229, 1777, 1597, 7717, 479, 5807, 5021, 2027,
        5849, 2687, 1697, 2089, 733, 653, 4801, 2351, 7589, 5449, 37, 3881, 2269, 6247, 7411, 4523, 3847, 2377, 3041, 3671, 3797, 641, 2287, 6547,
        1979, 2017, 6491, 6947, 137, 5333, 5477, 1063, 5861, 6917, 2551, 6779, 5197, 1321, 2521, 719, 3023, 1423, 7793, 1051, 6317, 419, 61, 919, 467,
        6007, 6659, 757, 2777, 5081, 4969, 5839, 1601, 5011, 3557, 7079, 7723, 4003, 3967, 6311, 1493, 1907, 6733, 4583, 239, 3331, 89, 7753, 7129,
        2113, 601, 409, 4339, 4127, 3469, 3163, 5503, 2423, 6151, 5897, 2207, 163, 3989, 4733, 3137, 6637, 7297, 151, 907, 1789, 4973, 1471, 6661,
        4051, 1609, 6353, 5669, 5927, 797, 7757, 5393, 2011, 1583, 349, 1867, 2663, 1741, 5479, 3643, 6841, 2081, 5647, 3767, 2539, 4099, 7349, 3691,
        1069, 3929, 41, 1447, 3947, 223, 4549, 5297, 6481, 4513, 6553, 3931, 199, 421, 2791, 2, 4079, 3533, 3391, 1217, 6619, 2399, 3517, 5879, 3733,
        2477, 3539, 1637, 1531, 5507, 6599, 3389, 2677, 6217, 701, 1871, 983, 4091, 1019, 691, 7481, 5519, 7703, 7577, 4129, 6653, 6029, 6257, 491,
        3701, 7499, 2903, 3907, 3607, 311, 3463, 3313, 1031, 2593, 4679, 809, 2851, 3299, 71, 1709, 5717, 2281, 7487, 5557, 31, 1997, 6521, 3301,
        1549, 6113, 5231, 2273, 449, 3319, 1723, 4111, 5101, 3719, 1109, 3361, 7741, 1237, 4363, 853, 3229, 6977, 4049, 4259, 389, 2861, 7529, 571,
        3187, 1097, 6203, 1861, 433, 881, 709, 3449, 3677, 6997, 1187, 7121, 2389, 2789, 3457, 2503, 4219, 7159, 1093, 2729, 3221, 2843, 1721, 1567,
        6397, 7433, 5437, 5407, 631, 7331, 7019, 3803, 7547, 4159, 6883, 4799, 293, 29, 3727, 7541, 7669, 1747, 3079, 1409, 2711, 563, 1277, 7243,
        4253, 6389, 7229, 317, 6199, 79, 4957, 3919, 5821, 6091, 4391, 5153, 2311, 6581, 383, 929, 4073, 5113, 2393, 5857, 1753, 997, 7877, 7687,
        367, 167, 577, 1013, 2083, 6269, 1621, 1151, 3943, 457, 193, 3083, 7207, 5279, 1439, 2801, 2153, 2671, 4001, 6271, 4243, 5483, 227, 941,
        3373, 181, 4931, 6299, 3271, 4793, 7489, 4229, 7039, 859, 1091, 1663, 283, 6277, 1999, 1201, 3673, 547, 1009, 7477, 2381, 401, 157, 197,
        5281, 101, 6329, 4817, 7603, 2689, 5851, 2819, 6089, 2659, 3109, 5801, 43, 6359, 4909, 3433, 1283, 6679, 6361, 1879, 2741, 7393, 7759, 4057,
        823, 6689, 1297, 4271, 593, 5417, 1319, 1153, 7321, 6473, 5413, 6959, 5701, 4787, 1181, 2357, 373, 5419, 5639, 2531, 7507, 107, 5381, 2473,
        5023, 4021, 6719, 1291, 5347, 1993, 5039, 607, 6691, 131, 5233, 1289, 2179, 2767, 3019, 6163, 5009, 3511, 3329, 3923, 3761, 877, 4447, 1087,
        683, 4943, 2341, 761, 821, 4987, 4483, 2143, 3631, 3359, 6961, 2459, 2857, 4283, 3089, 7591, 839, 503, 2243, 4903, 1693, 2437, 5237, 2953, 2063,
        7727, 7867, 3251, 5099, 3541, 5689, 5003, 7001, 4409, 5521, 3, 7351, 1433, 4643, 6379, 4517, 7853, 4133, 6047, 4937, 6571, 1613, 5227, 59, 7559,
        233, 1657, 1231, 7451, 5351, 5261, 1117, 1171, 2719, 5387, 4673, 4093, 2999, 2939, 6287, 4241, 2837, 1783, 4493, 6991, 7673, 4349, 991, 4153,
        113, 67, 4951, 6529, 3499, 179, 1511, 263, 73, 83, 1801, 2753, 7187, 281, 6781, 4019, 3307, 6803, 2617, 6067, 4789, 5179, 6983, 6263, 257, 173,
        7691, 7213, 3343, 7103, 5059, 1373, 6427, 1327, 2141, 677, 5987, 7237, 487, 1301, 1669, 6607, 5711, 4027, 1307, 1123, 6967, 4421, 6421, 619,
        4831, 5623, 7211, 3323, 277, 977, 6949, 1039, 2657, 2969, 2239, 2087, 2683, 2633, 673, 1931, 2347, 947]
